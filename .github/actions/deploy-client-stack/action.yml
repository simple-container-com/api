name: 'Deploy Simple Container Client Stack'
description: 'Deploy a Simple Container client stack using internal SC APIs'
branding:
  icon: 'upload-cloud'
  color: 'blue'

inputs:
  stack-name:
    description: 'Name of the stack to deploy'
    required: true
  environment:
    description: 'Target environment (staging, prod, etc.)'
    required: true
    default: 'staging'
  sc-config:
    description: 'Simple Container configuration (SC_CONFIG secret content)'
    required: true
  version:
    description: 'Version to deploy'
    required: false
    default: 'latest'
  pr-preview:
    description: 'Deploy as PR preview environment'
    required: false
    default: 'false'
  pr-number:
    description: 'Pull request number for preview deployments'
    required: false

outputs:
  version:
    description: 'Version that was deployed'
  environment:
    description: 'Environment that was deployed to'
  stack-name:
    description: 'Stack name that was deployed'
  duration:
    description: 'Deployment duration'
  status:
    description: 'Deployment status (success/failure)'

runs:
  using: 'docker'
  image: 'docker://simplecontainer/github-actions:staging'
  env:
    GITHUB_ACTION_TYPE: 'deploy-client-stack'
    STACK_NAME: ${{ inputs.stack-name }}
    ENVIRONMENT: ${{ inputs.environment }}
    SC_CONFIG: ${{ inputs.sc-config }}
    VERSION: ${{ inputs.version }}
    PR_PREVIEW: ${{ inputs.pr-preview }}
    PR_NUMBER: ${{ inputs.pr-number }}
    GITHUB_TOKEN: ${{ github.token }}
    GITHUB_REPOSITORY: ${{ github.repository }}
    GITHUB_SHA: ${{ github.sha }}
    GITHUB_REF: ${{ github.ref }}
